(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var block_1 = require("./block");
var Game = (function () {
    function Game() {
        this.colNum = 10;
        this.rawNum = 10;
        this.width = 30;
        this.bombNum = 10;
        this.bombArray = [];
        this.blockArray = [[], [], [], [], [], [], [], [], [], [], [], [], []];
        this.restBomb = this.bombNum;
    }
    Game.prototype.initUI = function () {
        var _this = this;
        this.area = document.createElement("div");
        this.area.style.width = (this.width + 2) * this.colNum + "px";
        this.area.style.height = (this.width + 2) * this.rawNum + "px";
        this.area.className = "area";
        document.body.appendChild(this.area);
        for (var i = 0; i < this.colNum; i++) {
            var _loop_1 = function() {
                block = document.createElement("div");
                block.className = "block";
                block.style.width = this_1.width + "px";
                block.style.height = this_1.width + "px";
                block.style.lineHeight = this_1.width + "px";
                var b;
                b = new block_1.default(block, false, "", i, j, this_1.colNum, this_1.rawNum);
                block.onmouseup = function (e) {
                    if (e.button == 0) {
                        if (!b.getFlag()) {
                            _this.turn(b);
                            if (b.getBomb()) {
                                _this.turnOtherBomb();
                                alert("Game Over!!!");
                            }
                        }
                    }
                    else if (e.button == 2) {
                        if (b.getContent() == "1") {
                            b.setContent("");
                            b.setFlag(false);
                            _this.restBomb++;
                        }
                        else {
                            b.setContent("1");
                            b.setFlag(true);
                            _this.restBomb--;
                        }
                        document.getElementsByClassName('bomb')[0].innerHTML = _this.restBomb + "";
                    }
                };
                this_1.blockArray[i][j] = b;
                this_1.area.appendChild(block);
            };
            var this_1 = this;
            var block;
            for (var j = 0; j < this.rawNum; j++) {
                _loop_1();
            }
        }
        var div = document.createElement("div");
        div.innerHTML = "剩余雷数：<label class='bomb'>" + this.restBomb + "</label>" +
            "<button onclick='window.location.reload();'>重新开始</button>";
        document.body.appendChild(div);
        //屏蔽鼠标右键定义的菜单功能
        this.area.oncontextmenu = function (event) {
            event.returnValue = false;
        };
        this.area.onselectstart = function (event) {
            event.returnValue = false;
        };
        //初始化雷区
        this.randomBomb();
        //初始化数字界面
        this.initNumber();
    };
    Game.prototype.turnOtherBomb = function () {
        for (var i = 0; i < this.bombArray.length; i++) {
            this.turn(this.blockArray[this.bombArray[i].x][this.bombArray[i].y]);
            this.blockArray[this.bombArray[i].x][this.bombArray[i].y].getElement().style.backgroundColor = "#000";
        }
    };
    Game.prototype.turn = function (block) {
        block.setTurn(true);
        block.getElement().onmouseup = null;
        if (block.getBlank()) {
            this.turnAround(block);
        }
        else if (block.getBomb()) {
            block.getElement().style.backgroundColor = "#000";
        }
        else {
            block.getElement().style.backgroundColor = "#fff";
            block.getElement().innerHTML = block.getInnerContent();
        }
    };
    Game.prototype.isNull = function (Bomb) {
        var i = Bomb.getX(), j = Bomb.getY();
        for (var x = i - 1; x < i + 2; x++) {
            for (var y = j - 1; y < j + 2; y++) {
                if (((x != i) || (y != j)) && (x >= 0) && (y >= 0)
                    && x < this.rawNum && y < this.colNum) {
                    if (this.blockArray[x][y].getBomb() == false
                        && this.blockArray[x][y].getTurn() == false) {
                        this.turn(this.blockArray[x][y]);
                    }
                }
            }
        }
    };
    Game.prototype.turnAround = function (block) {
        block.getElement().style.backgroundColor = "#fff";
        block.getElement().innerHTML = block.getInnerContent();
        this.isNull(block);
    };
    Game.prototype.initNumber = function () {
        for (var i = 0; i < this.colNum; i++) {
            for (var j = 0; j < this.rawNum; j++) {
                //当方块本身无雷的情况下，统计周围雷数
                var count = 0;
                if (!this.blockArray[i][j].getBomb()) {
                    for (var x = i - 1; x < i + 2; x++) {
                        for (var y = j - 1; y < j + 2; y++) {
                            if ((x >= 0) && (y >= 0) && (x < this.colNum) && (y < this.rawNum)) {
                                if (this.blockArray[x][y].getBomb()) {
                                    count++;
                                }
                            }
                        }
                    }
                }
                if (count == 0) {
                    this.blockArray[i][j].setInnerContent("");
                    this.blockArray[i][j].setBlank(true);
                }
                else {
                    this.blockArray[i][j].setInnerContent(count + "");
                    this.blockArray[i][j].setBlank(false);
                }
            }
        }
    };
    Game.prototype.randomBomb = function () {
        //生成随机雷数组
        while (this.bombArray.length < this.bombNum) {
            var x = Math.floor(Math.random() * this.colNum);
            var y = Math.floor(Math.random() * this.rawNum);
            if (this.bombArray.indexOf({ 'x': x, 'y': y }) == -1) {
                this.bombArray.push({ 'x': x, 'y': y });
            }
        }
        console.log(this.bombArray);
        //初始化雷
        for (var i = 0; i < this.bombArray.length; i++) {
            this.blockArray[this.bombArray[i].x][this.bombArray[i].y].setBomb(true);
        }
    };
    return Game;
}());
window.onload = function () {
    new Game().initUI();
};
},{"./block":2}],2:[function(require,module,exports){
"use strict";
//common block class,described the common property of block
var Block = (function () {
    function Block(elem, isBomb, content, x, y, col, raw) {
        this.isBomb = false;
        this.isBlank = true;
        this.isTurned = false;
        this.isFlag = false;
        this.content = "";
        this.innerContent = "";
        this.elem = elem;
        this.isBomb = isBomb;
        this.content = content;
        this.turnColor = this.isBomb ? "#000" : "#fff";
        this.x = x;
        this.y = y;
        this.raw = raw;
        this.col = col;
    }
    Block.prototype.setFlag = function (flag) {
        this.isFlag = flag;
    };
    Block.prototype.getFlag = function () {
        return this.isFlag;
    };
    Block.prototype.setBlank = function (flag) {
        this.isBlank = flag;
    };
    Block.prototype.getX = function () {
        return this.x;
    };
    Block.prototype.getY = function () {
        return this.y;
    };
    Block.prototype.getElement = function () {
        return this.elem;
    };
    Block.prototype.getBlank = function () {
        return this.isBlank;
    };
    Block.prototype.setTurn = function (flag) {
        this.isTurned = flag;
    };
    Block.prototype.setContent = function (content) {
        this.content = content;
        this.elem.innerHTML = this.content;
    };
    Block.prototype.setInnerContent = function (innerContent) {
        this.innerContent = innerContent;
        if (this.isTurned) {
            this.elem.innerHTML = this.innerContent;
        }
    };
    Block.prototype.setBomb = function (isBomb) {
        this.isBomb = isBomb;
        this.turnColor = this.isBomb ? "#000" : "#fff";
    };
    Block.prototype.getTurn = function () {
        return this.isTurned;
    };
    Block.prototype.getBomb = function () {
        return this.isBomb;
    };
    Block.prototype.getContent = function () {
        return this.content;
    };
    Block.prototype.getInnerContent = function () {
        return this.innerContent;
    };
    return Block;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = Block;
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvR2FtZS50cyIsInNyYy9ibG9jay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7QUNBQSxzQkFBa0IsU0FBUyxDQUFDLENBQUE7QUFFNUI7SUFBQTtRQUNFLFdBQU0sR0FBVyxFQUFFLENBQUM7UUFDcEIsV0FBTSxHQUFXLEVBQUUsQ0FBQztRQUNwQixVQUFLLEdBQVcsRUFBRSxDQUFDO1FBQ25CLFlBQU8sR0FBVyxFQUFFLENBQUM7UUFFckIsY0FBUyxHQUEwQixFQUFFLENBQUM7UUFDdEMsZUFBVSxHQUFjLENBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxDQUFDLENBQUM7UUFDakUsYUFBUSxHQUFXLElBQUksQ0FBQyxPQUFPLENBQUM7SUEySmxDLENBQUM7SUF6SkMscUJBQU0sR0FBTjtRQUFBLGlCQTZEQztRQTVEQyxJQUFJLENBQUMsSUFBSSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDMUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUM1RCxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO1FBQy9ELElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQztRQUM3QixRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJ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QUcsSUFBSSxDQUFDLE1BQU0sR0FBQyxNQUFNLEdBQUMsTUFBTSxDQUFDO0lBQzdDLENBQUM7SUFFRCx1QkFBTyxHQUFQO1FBQ0UsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdkIsQ0FBQztJQUVELHVCQUFPLEdBQVA7UUFDRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUNyQixDQUFDO0lBRUQsMEJBQVUsR0FBVjtRQUNFLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO0lBQ3RCLENBQUM7SUFFRCwrQkFBZSxHQUFmO1FBQ0UsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7SUFDM0IsQ0FBQztJQUlILFlBQUM7QUFBRCxDQTVGQSxBQTRGQyxJQUFBO0FBNUZEO3VCQTRGQyxDQUFBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCBCbG9jayBmcm9tIFwiLi9ibG9ja1wiO1xyXG5cclxuY2xhc3MgR2FtZSB7XHJcbiAgY29sTnVtOiBudW1iZXIgPSAxMDtcclxuICByYXdOdW06IG51bWJlciA9IDEwO1xyXG4gIHdpZHRoOiBudW1iZXIgPSAzMDtcclxuICBib21iTnVtOiBudW1iZXIgPSAxMDtcclxuICBhcmVhOiBIVE1MRWxlbWVudDtcclxuICBib21iQXJyYXk6IHt4Om51bWJlcix5Om51bWJlcn1bXSA9IFtdO1xyXG4gIGJsb2NrQXJyYXk6IEJsb2NrW11bXSA9IFtbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXV07XHJcbiAgcmVzdEJvbWI6IG51bWJlciA9IHRoaXMuYm9tYk51bTtcclxuXHJcbiAgaW5pdFVJKCl7XHJcbiAgICB0aGlzLmFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgdGhpcy5hcmVhLnN0eWxlLndpZHRoID0gKHRoaXMud2lkdGgrMikgKiB0aGlzLmNvbE51bSArIFwicHhcIjtcclxuICAgIHRoaXMuYXJlYS5zdHlsZS5oZWlnaHQgPSAodGhpcy53aWR0aCArIDIpICogdGhpcy5yYXdOdW0gKyBcInB4XCI7XHJcbiAgICB0aGlzLmFyZWEuY2xhc3NOYW1lID0gXCJhcmVhXCI7XHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuYXJlYSk7XHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5jb2xOdW07IGkgKyspIHtcclxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnJhd051bTsgaiArKykge1xyXG4gICAgICAgIHZhciBibG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgYmxvY2suY2xhc3NOYW1lID0gXCJibG9ja1wiO1xyXG4gICAgICAgIGJsb2NrLnN0eWxlLndpZHRoID0gdGhpcy53aWR0aCArIFwicHhcIjtcclxuICAgICAgICBibG9jay5zdHlsZS5oZWlnaHQgPSB0aGlzLndpZHRoICsgXCJweFwiO1xyXG4gICAgICAgIGJsb2NrLnN0eWxlLmxpbmVIZWlnaHQgPSB0aGlzLndpZHRoICsgXCJweFwiO1xyXG4gICAgICAgIGxldCBiOiBCbG9jaztcclxuICAgICAgICBiID0gbmV3IEJsb2NrKGJsb2NrLGZhbHNlLFwiXCIsaSxqLHRoaXMuY29sTnVtLHRoaXMucmF3TnVtKTtcclxuICAgICAgICBibG9jay5vbm1vdXNldXAgPSAoZSk9PntcclxuICAgICAgICAgIGlmIChlLmJ1dHRvbiA9PSAwKSB7IC8vIOm8oOagh+W3pumUruaMieS4i1xyXG4gICAgICAgICAgICBpZiAoIWIuZ2V0RmxhZygpKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy50dXJuKGIpO1xyXG4gICAgICAgICAgICAgIGlmIChiLmdldEJvbWIoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50dXJuT3RoZXJCb21iKCk7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIkdhbWUgT3ZlciEhIVwiKTtcclxuICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAoZS5idXR0b24gPT0gMikgeyAvL+m8oOagh+WPs+mUruaMieS4i1xyXG4gICAgICAgICAgICBpZiAoYi5nZXRDb250ZW50KCkgPT0gXCIxXCIpIHtcclxuICAgICAgICAgICAgICBiLnNldENvbnRlbnQoXCJcIik7XHJcbiAgICAgICAgICAgICAgYi5zZXRGbGFnKGZhbHNlKTtcclxuICAgICAgICAgICAgICB0aGlzLnJlc3RCb21iICsrO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGIuc2V0Q29udGVudChcIjFcIik7XHJcbiAgICAgICAgICAgICAgYi5zZXRGbGFnKHRydWUpO1xyXG4gICAgICAgICAgICAgIHRoaXMucmVzdEJvbWIgLS07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYm9tYicpWzBdLmlubmVySFRNTCA9IHRoaXMucmVzdEJvbWIgK1wiXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmJsb2NrQXJyYXlbaV1bal0gPSBiO1xyXG4gICAgICAgIHRoaXMuYXJlYS5hcHBlbmRDaGlsZChibG9jayk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGRpdi5pbm5lckhUTUwgPSBcIuWJqeS9membt+aVsO+8mjxsYWJlbCBjbGFzcz0nYm9tYic+XCIrIHRoaXMucmVzdEJvbWIgK1wiPC9sYWJlbD5cIiArXHJcbiAgICBcIjxidXR0b24gb25jbGljaz0nd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOyc+6YeN5paw5byA5aeLPC9idXR0b24+XCI7XHJcblxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXYpO1xyXG4gICAgLy/lsY/olL3pvKDmoIflj7PplK7lrprkuYnnmoToj5zljZXlip/og71cclxuICAgIHRoaXMuYXJlYS5vbmNvbnRleHRtZW51PWZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgIGV2ZW50LnJldHVyblZhbHVlPWZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYXJlYS5vbnNlbGVjdHN0YXJ0PWZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgIGV2ZW50LnJldHVyblZhbHVlPWZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8v5Yid5aeL5YyW6Zu35Yy6XHJcbiAgICB0aGlzLnJhbmRvbUJvbWIoKTtcclxuICAgIC8v5Yid5aeL5YyW5pWw5a2X55WM6Z2iXHJcbiAgICB0aGlzLmluaXROdW1iZXIoKTtcclxuICB9XHJcblxyXG4gIHR1cm5PdGhlckJvbWIoKSB7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYm9tYkFycmF5Lmxlbmd0aDsgaSArKykge1xyXG4gICAgICB0aGlzLnR1cm4odGhpcy5ibG9ja0FycmF5W3RoaXMuYm9tYkFycmF5W2ldLnhdW3RoaXMuYm9tYkFycmF5W2ldLnldKTtcclxuICAgICAgdGhpcy5ibG9ja0FycmF5W3RoaXMuYm9tYkFycmF5W2ldLnhdW3RoaXMuYm9tYkFycmF5W2ldLnldLmdldEVsZW1lbnQoKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMwMDBcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHR1cm4oYmxvY2s6IEJsb2NrKSB7XHJcbiAgICBibG9jay5zZXRUdXJuKHRydWUpO1xyXG4gICAgYmxvY2suZ2V0RWxlbWVudCgpLm9ubW91c2V1cCA9IG51bGw7XHJcbiAgICBpZiAoYmxvY2suZ2V0QmxhbmsoKSkge1xyXG4gICAgICB0aGlzLnR1cm5Bcm91bmQoYmxvY2spO1xyXG4gICAgfSBlbHNlIGlmKGJsb2NrLmdldEJvbWIoKSkge1xyXG4gICAgICBibG9jay5nZXRFbGVtZW50KCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDAwXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBibG9jay5nZXRFbGVtZW50KCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmXCI7XHJcbiAgICAgIGJsb2NrLmdldEVsZW1lbnQoKS5pbm5lckhUTUwgPSBibG9jay5nZXRJbm5lckNvbnRlbnQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlzTnVsbChCb21iOiBCbG9jayk6dm9pZCB7XHJcbiAgICB2YXIgaTpudW1iZXIgPSBCb21iLmdldFgoKSwgajpudW1iZXIgPSBCb21iLmdldFkoKTtcclxuXHJcbiAgICBmb3IgKHZhciB4ID0gaSAtIDE7IHggPCBpICsgMjsgeCsrKSB7XHJcbiAgICAgIGZvciAodmFyIHkgPSBqIC0gMTsgeSA8IGogKyAyOyB5KyspIHtcclxuICAgICAgICBpZiAoICggKHggIT0gaSkgfHwgKHkgIT0gaikpICYmICh4ID49IDApICYmICh5ID49IDApXHJcbiAgICAgICAgICAgICYmIHggPCB0aGlzLnJhd051bSAmJiB5IDwgdGhpcy5jb2xOdW0pIHtcclxuICAgICAgICAgIGlmICh0aGlzLmJsb2NrQXJyYXlbeF1beV0uZ2V0Qm9tYigpID09IGZhbHNlXHJcbiAgICAgICAgICAgICAgJiYgdGhpcy5ibG9ja0FycmF5W3hdW3ldLmdldFR1cm4oKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLnR1cm4odGhpcy5ibG9ja0FycmF5W3hdW3ldKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHR1cm5Bcm91bmQoYmxvY2s6IEJsb2NrKSB7XHJcbiAgICBibG9jay5nZXRFbGVtZW50KCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmXCI7XHJcbiAgICBibG9jay5nZXRFbGVtZW50KCkuaW5uZXJIVE1MID0gYmxvY2suZ2V0SW5uZXJDb250ZW50KCk7XHJcbiAgICB0aGlzLmlzTnVsbChibG9jayk7XHJcbiAgfVxyXG5cclxuICBpbml0TnVtYmVyKCkge1xyXG4gICAgZm9yKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmNvbE51bTsgaSArKykge1xyXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMucmF3TnVtOyBqICsrKSB7XHJcbiAgICAgICAgLy/lvZPmlrnlnZfmnKzouqvml6Dpm7fnmoTmg4XlhrXkuIvvvIznu5/orqHlkajlm7Tpm7fmlbBcclxuICAgICAgICB2YXIgY291bnQ6IG51bWJlciA9IDA7XHJcbiAgICAgICAgaWYgKCF0aGlzLmJsb2NrQXJyYXlbaV1bal0uZ2V0Qm9tYigpKSB7XHJcbiAgICAgICAgICBmb3IgKHZhciB4ID0gaSAtIDE7IHggPCBpICsgMjsgeCArKykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciB5ID0gaiAtIDE7IHkgPCBqICsgMjsgeSArKykge1xyXG4gICAgICAgICAgICAgIGlmICggKHggPj0gMCkgJiYgKHkgPj0gMCkgJiYgKHggPCB0aGlzLmNvbE51bSkgJiYgKHkgPCB0aGlzLnJhd051bSkgKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ibG9ja0FycmF5W3hdW3ldLmdldEJvbWIoKSkge1xyXG4gICAgICAgICAgICAgICAgICBjb3VudCArKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjb3VudCA9PSAwKSB7XHJcbiAgICAgICAgICB0aGlzLmJsb2NrQXJyYXlbaV1bal0uc2V0SW5uZXJDb250ZW50KFwiXCIpO1xyXG4gICAgICAgICAgdGhpcy5ibG9ja0FycmF5W2ldW2pdLnNldEJsYW5rKHRydWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmJsb2NrQXJyYXlbaV1bal0uc2V0SW5uZXJDb250ZW50KGNvdW50ICsgXCJcIik7XHJcbiAgICAgICAgICB0aGlzLmJsb2NrQXJyYXlbaV1bal0uc2V0QmxhbmsoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICByYW5kb21Cb21iKCkge1xyXG4gICAgLy/nlJ/miJDpmo/mnLrpm7fmlbDnu4RcclxuICAgIHdoaWxlKHRoaXMuYm9tYkFycmF5Lmxlbmd0aCA8IHRoaXMuYm9tYk51bSkge1xyXG4gICAgICB2YXIgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSp0aGlzLmNvbE51bSk7XHJcbiAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnRoaXMucmF3TnVtKTtcclxuICAgICAgaWYgKHRoaXMuYm9tYkFycmF5LmluZGV4T2Yoeyd4Jzp4LCd5Jzp5fSkgPT0gLTEpIHtcclxuICAgICAgICB0aGlzLmJvbWJBcnJheS5wdXNoKHsneCc6eCwneSc6eX0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2codGhpcy5ib21iQXJyYXkpO1xyXG4gICAgLy/liJ3lp4vljJbpm7dcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ib21iQXJyYXkubGVuZ3RoOyBpICsrKSB7XHJcbiAgICAgIHRoaXMuYmxvY2tBcnJheVt0aGlzLmJvbWJBcnJheVtpXS54XVt0aGlzLmJvbWJBcnJheVtpXS55XS5zZXRCb21iKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG59XHJcblxyXG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgbmV3IEdhbWUoKS5pbml0VUkoKTtcclxufTtcclxuIiwiLy9jb21tb24gYmxvY2sgY2xhc3MsZGVzY3JpYmVkIHRoZSBjb21tb24gcHJvcGVydHkgb2YgYmxvY2tcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmxvY2sge1xyXG4gIHByb3RlY3RlZCBpc0JvbWI6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwcm90ZWN0ZWQgaXNCbGFuazogYm9vbGVhbiA9IHRydWU7XHJcbiAgcHJvdGVjdGVkIGlzVHVybmVkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHJvdGVjdGVkIGlzRmxhZzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHByb3RlY3RlZCB0dXJuQ29sb3I6c3RyaW5nO1xyXG4gIHByb3RlY3RlZCBjb250ZW50OiBzdHJpbmcgPSBcIlwiO1xyXG4gIHByb3RlY3RlZCBpbm5lckNvbnRlbnQ6IHN0cmluZyA9IFwiXCI7XHJcbiAgcHJvdGVjdGVkIGVsZW06IEhUTUxFbGVtZW50O1xyXG4gIHByb3RlY3RlZCB4OiBudW1iZXI7XHJcbiAgcHJvdGVjdGVkIHk6IG51bWJlcjtcclxuICBwcm90ZWN0ZWQgcmF3OiBudW1iZXI7XHJcbiAgcHJvdGVjdGVkIGNvbDogbnVtYmVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihlbGVtOiBIVE1MRWxlbWVudCwgaXNCb21iOiBib29sZWFuLCBjb250ZW50OiBzdHJpbmcseDogbnVtYmVyLHk6IG51bWJlcixjb2w6IG51bWJlciwgcmF3OiBudW1iZXIpIHtcclxuICAgIHRoaXMuZWxlbSA9IGVsZW07XHJcbiAgICB0aGlzLmlzQm9tYiA9IGlzQm9tYjtcclxuICAgIHRoaXMuY29udGVudCA9IGNvbnRlbnQ7XHJcbiAgICB0aGlzLnR1cm5Db2xvciA9IHRoaXMuaXNCb21iP1wiIzAwMFwiOlwiI2ZmZlwiO1xyXG4gICAgdGhpcy54ID0geDtcclxuICAgIHRoaXMueSA9IHk7XHJcbiAgICB0aGlzLnJhdyA9IHJhdztcclxuICAgIHRoaXMuY29sID0gY29sO1xyXG4gIH1cclxuXHJcbiAgc2V0RmxhZyhmbGFnOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLmlzRmxhZyA9IGZsYWc7XHJcbiAgfVxyXG5cclxuICBnZXRGbGFnKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaXNGbGFnO1xyXG4gIH1cclxuXHJcbiAgc2V0QmxhbmsoZmxhZzogYm9vbGVhbikge1xyXG4gICAgdGhpcy5pc0JsYW5rID0gZmxhZztcclxuICB9XHJcblxyXG4gIGdldFgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy54O1xyXG4gIH1cclxuXHJcbiAgZ2V0WSgpIHtcclxuICAgIHJldHVybiB0aGlzLnk7XHJcbiAgfVxyXG5cclxuICBnZXRFbGVtZW50KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZWxlbTtcclxuICB9XHJcblxyXG4gIGdldEJsYW5rKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaXNCbGFuaztcclxuICB9XHJcblxyXG4gIHNldFR1cm4oZmxhZzogYm9vbGVhbikge1xyXG4gICAgdGhpcy5pc1R1cm5lZCA9IGZsYWc7XHJcbiAgfVxyXG5cclxuICBzZXRDb250ZW50KGNvbnRlbnQ6IHN0cmluZykge1xyXG4gICAgdGhpcy5jb250ZW50ID0gY29udGVudDtcclxuICAgIHRoaXMuZWxlbS5pbm5lckhUTUwgPSB0aGlzLmNvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBzZXRJbm5lckNvbnRlbnQoaW5uZXJDb250ZW50OiBzdHJpbmcpIHtcclxuICAgIHRoaXMuaW5uZXJDb250ZW50ID0gaW5uZXJDb250ZW50O1xyXG4gICAgaWYgKHRoaXMuaXNUdXJuZWQpIHtcclxuICAgICAgdGhpcy5lbGVtLmlubmVySFRNTCA9IHRoaXMuaW5uZXJDb250ZW50O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0Qm9tYihpc0JvbWI6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuaXNCb21iID0gaXNCb21iO1xyXG4gICAgdGhpcy50dXJuQ29sb3IgPSB0aGlzLmlzQm9tYj9cIiMwMDBcIjpcIiNmZmZcIjtcclxuICB9XHJcblxyXG4gIGdldFR1cm4oKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5pc1R1cm5lZDtcclxuICB9XHJcblxyXG4gIGdldEJvbWIoKTogYm9vbGVhbntcclxuICAgIHJldHVybiB0aGlzLmlzQm9tYjtcclxuICB9XHJcblxyXG4gIGdldENvbnRlbnQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb250ZW50O1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5uZXJDb250ZW50KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaW5uZXJDb250ZW50O1xyXG4gIH1cclxuXHJcblxyXG5cclxufVxyXG4iXX0=
